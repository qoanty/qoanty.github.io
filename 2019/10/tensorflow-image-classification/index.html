<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    

    <title>TensorFlow基本分类：对服装图像进行分类 | 百年孤独的博客</title>
    <meta property="og:title" content="TensorFlow基本分类：对服装图像进行分类 - 百年孤独的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2019-10-08T15:21:42&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2019-10-08T15:21:42&#43;08:00'>
        
    <meta name="Keywords" content="VPS, python, android, 博客, 小程序">
    <meta name="description" content="TensorFlow基本分类：对服装图像进行分类">
        
    <meta name="author" content="百年孤独">
    <meta property="og:url" content="https://qoanty.github.io/2019/10/tensorflow-image-classification/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://qoanty.github.io/">
                        百年孤独的博客
                    </a>
                
                <p class="description">艺术家用谎言揭露真相，政治家用谎言隐瞒真相</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://qoanty.github.io/">首页</a>
                    
                    <a  href="https://qoanty.github.io/tools/" title="工具">工具</a>
                    
                    <a  href="https://qoanty.github.io/archives/" title="归档">归档</a>
                    
                    <a  href="https://qoanty.github.io/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">TensorFlow基本分类：对服装图像进行分类</h1>
        </header>
        <date class="post-meta meta-date">
            2019年10月8日
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='/categories/learn'>Learn</a></span>
            
            <span class="meta-category"><a href='/categories/tensorflow'>TensorFlow</a></span>
            
        </div>
        
        
        
        <div class="post-content">
            <p><a href="https://www.tensorflow.org/tutorials/keras/classification">本指南</a>训练了一个神经网络模型，以对运动鞋和衬衫等服装图像进行分类。你可以不了解所有的细节，这是一个完整的TensorFlow程序的快速概述，详细内容会在你开始的时候解释。</p>
<p>本指南使用<a href="https://www.tensorflow.org/guide/keras">tf.keras</a>，一个高级API来中构建和训练TensorFlow模型。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">__future__</span> <span style="color:#000;font-weight:bold">import</span> absolute_import, division, print_function, unicode_literals

<span style="color:#998;font-style:italic"># TensorFlow and tf.keras</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#555">tensorflow</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">tf</span>
<span style="color:#000;font-weight:bold">from</span> <span style="color:#555">tensorflow</span> <span style="color:#000;font-weight:bold">import</span> keras

<span style="color:#998;font-style:italic"># Helper libraries</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#555">numpy</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">np</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#555">matplotlib.pyplot</span> <span style="color:#000;font-weight:bold">as</span> <span style="color:#555">plt</span>

<span style="color:#000;font-weight:bold">print</span>(tf<span style="color:#000;font-weight:bold">.</span>__version__)

<span style="color:#099">2.0</span><span style="color:#000;font-weight:bold">.</span><span style="color:#099">0</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="导入fashion-mnist数据集">导入Fashion MNIST数据集</h2>
<p>本指南使用<a href="https://github.com/zalandoresearch/fashion-mnist">Fashion MNIST</a>数据集，其中包含10个类别的70,000个灰度图像。这些图像以低分辨率（28*28像素）显示衣服的各个物品，如下所示：</p>
<p>
        <img class="mx-auto" alt="" src="/images/tfkb1.png" />   
    </p>
<!-- raw HTML omitted -->
<p>Fashion MNIST旨在替代经典<a href="http://yann.lecun.com/exdb/mnist/">MNIST</a>数据集，该数据集通常被用作计算机视觉机器学习程序的“Hello, World”。MNIST数据集包含手写数字（0、1、2等）的图像，其格式与你将在此处使用的衣服的格式相同。</p>
<p>本指南将Fashion MNIST用于多种用途，因此它比常规MNIST更具挑战性。两个数据集都相对较小，用于验证算法是否按预期工作。它们是测试和调试代码的良好起点。</p>
<p>这里，使用60,000张图像来训练网络，使用10,000张图像来评估网络学习对图像进行分类的准确程度。你可以直接从TensorFlow访问Fashion MNIST。直接从TensorFlow导入和加载Fashion MNIST数据：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fashion_mnist <span style="color:#000;font-weight:bold">=</span> keras<span style="color:#000;font-weight:bold">.</span>datasets<span style="color:#000;font-weight:bold">.</span>fashion_mnist
(train_images, train_labels), (test_images, test_labels) <span style="color:#000;font-weight:bold">=</span> fashion_mnist<span style="color:#000;font-weight:bold">.</span>load_data()

Downloading data <span style="color:#000;font-weight:bold">from</span> <span style="color:#555">https</span>:<span style="color:#000;font-weight:bold">//</span>storage<span style="color:#000;font-weight:bold">.</span>googleapis<span style="color:#000;font-weight:bold">.</span>com<span style="color:#000;font-weight:bold">/</span>tensorflow<span style="color:#000;font-weight:bold">/</span>tf<span style="color:#000;font-weight:bold">-</span>keras<span style="color:#000;font-weight:bold">-</span>datasets<span style="color:#000;font-weight:bold">/</span>train<span style="color:#000;font-weight:bold">-</span>labels<span style="color:#000;font-weight:bold">-</span>idx1<span style="color:#000;font-weight:bold">-</span>ubyte<span style="color:#000;font-weight:bold">.</span>gz
<span style="color:#099">32768</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">29515</span> [<span style="color:#000;font-weight:bold">=================================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">0</span>s <span style="color:#099">0</span>us<span style="color:#000;font-weight:bold">/</span>step
Downloading data <span style="color:#000;font-weight:bold">from</span> <span style="color:#555">https</span>:<span style="color:#000;font-weight:bold">//</span>storage<span style="color:#000;font-weight:bold">.</span>googleapis<span style="color:#000;font-weight:bold">.</span>com<span style="color:#000;font-weight:bold">/</span>tensorflow<span style="color:#000;font-weight:bold">/</span>tf<span style="color:#000;font-weight:bold">-</span>keras<span style="color:#000;font-weight:bold">-</span>datasets<span style="color:#000;font-weight:bold">/</span>train<span style="color:#000;font-weight:bold">-</span>images<span style="color:#000;font-weight:bold">-</span>idx3<span style="color:#000;font-weight:bold">-</span>ubyte<span style="color:#000;font-weight:bold">.</span>gz
<span style="color:#099">26427392</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">26421880</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">0</span>s <span style="color:#099">0</span>us<span style="color:#000;font-weight:bold">/</span>step
Downloading data <span style="color:#000;font-weight:bold">from</span> <span style="color:#555">https</span>:<span style="color:#000;font-weight:bold">//</span>storage<span style="color:#000;font-weight:bold">.</span>googleapis<span style="color:#000;font-weight:bold">.</span>com<span style="color:#000;font-weight:bold">/</span>tensorflow<span style="color:#000;font-weight:bold">/</span>tf<span style="color:#000;font-weight:bold">-</span>keras<span style="color:#000;font-weight:bold">-</span>datasets<span style="color:#000;font-weight:bold">/</span>t10k<span style="color:#000;font-weight:bold">-</span>labels<span style="color:#000;font-weight:bold">-</span>idx1<span style="color:#000;font-weight:bold">-</span>ubyte<span style="color:#000;font-weight:bold">.</span>gz
<span style="color:#099">8192</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">5148</span> [<span style="color:#000;font-weight:bold">===============================================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">0</span>s <span style="color:#099">0</span>us<span style="color:#000;font-weight:bold">/</span>step
Downloading data <span style="color:#000;font-weight:bold">from</span> <span style="color:#555">https</span>:<span style="color:#000;font-weight:bold">//</span>storage<span style="color:#000;font-weight:bold">.</span>googleapis<span style="color:#000;font-weight:bold">.</span>com<span style="color:#000;font-weight:bold">/</span>tensorflow<span style="color:#000;font-weight:bold">/</span>tf<span style="color:#000;font-weight:bold">-</span>keras<span style="color:#000;font-weight:bold">-</span>datasets<span style="color:#000;font-weight:bold">/</span>t10k<span style="color:#000;font-weight:bold">-</span>images<span style="color:#000;font-weight:bold">-</span>idx3<span style="color:#000;font-weight:bold">-</span>ubyte<span style="color:#000;font-weight:bold">.</span>gz
<span style="color:#099">4423680</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">4422102</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">0</span>s <span style="color:#099">0</span>us<span style="color:#000;font-weight:bold">/</span>step
</code></pre></td></tr></table>
</div>
</div><p>加载数据集将返回四个NumPy数组：</p>
<ul>
<li><code>train_images</code>和<code>train_labels</code>数组是模型用来学习的数据训练集。</li>
<li>针对测试集<code>test_images</code>和<code>test_labels</code>数组对模型进行测试。</li>
</ul>
<p>图像是28*28 NumPy数组，像素值从0到255不等。标签是一个整数数组，范围从0到9。这些对应于图像所代表的衣服类别：</p>
<table>
<thead>
<tr>
<th>标签</th>
<th>类</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>T-shirt/top</td>
</tr>
<tr>
<td>1</td>
<td>Trouser</td>
</tr>
<tr>
<td>2</td>
<td>Pullover</td>
</tr>
<tr>
<td>3</td>
<td>Dress</td>
</tr>
<tr>
<td>4</td>
<td>Coat</td>
</tr>
<tr>
<td>5</td>
<td>Sandal</td>
</tr>
<tr>
<td>6</td>
<td>Shirt</td>
</tr>
<tr>
<td>7</td>
<td>Sneaker</td>
</tr>
<tr>
<td>8</td>
<td>Bag</td>
</tr>
<tr>
<td>9</td>
<td>Ankle boot</td>
</tr>
</tbody>
</table>
<p>每个图像都对应一个标签。由于类名不包含在数据集中，因此将它们存储在此处，以便后面在绘制图像时使用：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">class_names <span style="color:#000;font-weight:bold">=</span> [<span style="color:#d14">&#39;T-shirt/top&#39;</span>, <span style="color:#d14">&#39;Trouser&#39;</span>, <span style="color:#d14">&#39;Pullover&#39;</span>, <span style="color:#d14">&#39;Dress&#39;</span>, <span style="color:#d14">&#39;Coat&#39;</span>,
               <span style="color:#d14">&#39;Sandal&#39;</span>, <span style="color:#d14">&#39;Shirt&#39;</span>, <span style="color:#d14">&#39;Sneaker&#39;</span>, <span style="color:#d14">&#39;Bag&#39;</span>, <span style="color:#d14">&#39;Ankle boot&#39;</span>]
</code></pre></td></tr></table>
</div>
</div><h2 id="研究数据">研究数据</h2>
<p>在训练模型之前，让我们先研究一下数据集的格式。下面显示训练集中有60,000张图像，每张图像表示为28*28像素：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_images<span style="color:#000;font-weight:bold">.</span>shape
(<span style="color:#099">60000</span>, <span style="color:#099">28</span>, <span style="color:#099">28</span>)
</code></pre></td></tr></table>
</div>
</div><p>同样，训练集中有60,000个标签：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#0086b3">len</span>(train_labels)
<span style="color:#099">60000</span>
</code></pre></td></tr></table>
</div>
</div><p>每个标签都是0到9之间的整数：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_labels
array([<span style="color:#099">9</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#000;font-weight:bold">...</span>, <span style="color:#099">3</span>, <span style="color:#099">0</span>, <span style="color:#099">5</span>], dtype<span style="color:#000;font-weight:bold">=</span>uint8)
</code></pre></td></tr></table>
</div>
</div><p>测试集中有10,000张图像。同样，每个图像都表示为28*28像素：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">test_images<span style="color:#000;font-weight:bold">.</span>shape
(<span style="color:#099">10000</span>, <span style="color:#099">28</span>, <span style="color:#099">28</span>)
</code></pre></td></tr></table>
</div>
</div><p>测试集包含10,000个图像标签：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#0086b3">len</span>(test_labels)
<span style="color:#099">10000</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="预处理数据">预处理数据</h2>
<p>在训练网络之前，必须对数据进行预处理。如果你检查训练集中的第一张图像，将会看到像素值在0到255范围内：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#000;font-weight:bold">.</span>figure()
plt<span style="color:#000;font-weight:bold">.</span>imshow(train_images[<span style="color:#099">0</span>])
plt<span style="color:#000;font-weight:bold">.</span>colorbar()
plt<span style="color:#000;font-weight:bold">.</span>grid(<span style="color:#999">False</span>)
plt<span style="color:#000;font-weight:bold">.</span>show()
</code></pre></td></tr></table>
</div>
</div><p>
        <img class="mx-auto" alt="" src="/images/tfkb2.png" />   
    </p>
<p>在将这些值输入神经网络模型之前，将它们缩放到0到1的范围。为此，将这些值除以255。以相同的方式预处理训练集和测试集是非常重要：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_images <span style="color:#000;font-weight:bold">=</span> train_images <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">255.0</span>
test_images <span style="color:#000;font-weight:bold">=</span> test_images <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">255.0</span>
</code></pre></td></tr></table>
</div>
</div><p>为了验证数据的格式是否正确，以及是否准备好构建和训练网络，让我们显示训练集中的前25张图像，并在每个图像下方显示类名称。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#000;font-weight:bold">.</span>figure(figsize<span style="color:#000;font-weight:bold">=</span>(<span style="color:#099">10</span>,<span style="color:#099">10</span>))
<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">25</span>):
    plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">5</span>,<span style="color:#099">5</span>,i<span style="color:#000;font-weight:bold">+</span><span style="color:#099">1</span>)
    plt<span style="color:#000;font-weight:bold">.</span>xticks([])
    plt<span style="color:#000;font-weight:bold">.</span>yticks([])
    plt<span style="color:#000;font-weight:bold">.</span>grid(<span style="color:#999">False</span>)
    plt<span style="color:#000;font-weight:bold">.</span>imshow(train_images[i], cmap<span style="color:#000;font-weight:bold">=</span>plt<span style="color:#000;font-weight:bold">.</span>cm<span style="color:#000;font-weight:bold">.</span>binary)
    plt<span style="color:#000;font-weight:bold">.</span>xlabel(class_names[train_labels[i]])
plt<span style="color:#000;font-weight:bold">.</span>show()
</code></pre></td></tr></table>
</div>
</div><p>
        <img class="mx-auto" alt="" src="/images/tfkb3.png" />   
    </p>
<h2 id="建立模型">建立模型</h2>
<p>建立神经网络需要配置模型的各层，然后编译模型。</p>
<p><strong>设置图层</strong></p>
<p>神经网络的基本构建模块是层。层从输入到它们的数据中提取特征。希望这些特征对于当前的问题有意义。</p>
<p>深度学习的大部分内容是将简单的层链接在一起。大多数层（例如<code>tf.keras.layers.Dense</code>）都有在训练期间学习的参数。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model <span style="color:#000;font-weight:bold">=</span> keras<span style="color:#000;font-weight:bold">.</span>Sequential([
    keras<span style="color:#000;font-weight:bold">.</span>layers<span style="color:#000;font-weight:bold">.</span>Flatten(input_shape<span style="color:#000;font-weight:bold">=</span>(<span style="color:#099">28</span>, <span style="color:#099">28</span>)),
    keras<span style="color:#000;font-weight:bold">.</span>layers<span style="color:#000;font-weight:bold">.</span>Dense(<span style="color:#099">128</span>, activation<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;relu&#39;</span>),
    keras<span style="color:#000;font-weight:bold">.</span>layers<span style="color:#000;font-weight:bold">.</span>Dense(<span style="color:#099">10</span>, activation<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;softmax&#39;</span>)
])
</code></pre></td></tr></table>
</div>
</div><p>网络的第一层<code>tf.keras.layers.Flatten</code>将图像的格式从二维数组（28<em>28像素）转换为一维数组（28</em>28=784像素）。可以将这一层看作是图像中的一行行像素并将它们排列起来。该层没有要学习的参数，它只是重新格式化数据。</p>
<p>像素展平后，网络由两个<code>tf.keras.layers.Dense</code>层组成。这些是紧密连接或完全连接的神经层。第一个密集层有128个节点（或神经元）。第二层（也是最后一层）是有10个节点的softmax层，该层返回一个含有10个概率值的数组，其总和为1。每个节点都包含一个分数，该分数表示当前图像属于哪个类别的概率。</p>
<p><strong>编译模型</strong></p>
<p>在模型准备训练好之前，还需要进行一些设置。这些是在模型的编译步骤中添加的：</p>
<ul>
<li>损失函数：衡量训练期间模型的准确性。你希望最小化此函数，以便将模型“引导”到正确的方向上。</li>
<li>优化器：这是基于模型看到的数据及其损失函数来更新模型的方式。</li>
<li>指标：用于监控训练和测试步骤。下面的例子使用准确性，即正确分类的图像比例。</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model<span style="color:#000;font-weight:bold">.</span>compile(optimizer<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;adam&#39;</span>,
              loss<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;sparse_categorical_crossentropy&#39;</span>,
              metrics<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;accuracy&#39;</span>])
</code></pre></td></tr></table>
</div>
</div><h2 id="训练模型">训练模型</h2>
<p>训练神经网络模型需要执行以下步骤：</p>
<ol>
<li>将训练数据输入模型。在本例中，训练数据为<code>train_images</code>和<code>train_labels</code>数组。</li>
<li>与模型学习关联的图像和标签。</li>
<li>要求模型对测试集（在本例中为<code>test_images</code>数组）做出预测。验证预测是否与<code>test_labels</code>数组中的标签匹配。</li>
</ol>
<p>调用<code>model.fit</code>方法开始训练，之所以这么称呼是因为该方法使模型“适合”训练数据：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model<span style="color:#000;font-weight:bold">.</span>fit(train_images, train_labels, epochs<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>)

Train on <span style="color:#099">60000</span> samples
Epoch <span style="color:#099">1</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">5</span>s <span style="color:#099">85</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.4978</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.8245</span>
Epoch <span style="color:#099">2</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">4</span>s <span style="color:#099">69</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.3798</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.8624</span>
Epoch <span style="color:#099">3</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">4</span>s <span style="color:#099">62</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.3411</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.8762</span>
Epoch <span style="color:#099">4</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">4</span>s <span style="color:#099">61</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.3164</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.8838</span>
Epoch <span style="color:#099">5</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">4</span>s <span style="color:#099">61</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.2956</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.8902</span>
Epoch <span style="color:#099">6</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">4</span>s <span style="color:#099">64</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.2815</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.8955</span>
Epoch <span style="color:#099">7</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">4</span>s <span style="color:#099">65</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.2691</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.9009</span>
Epoch <span style="color:#099">8</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">4</span>s <span style="color:#099">62</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.2579</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.9029</span>
Epoch <span style="color:#099">9</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">4</span>s <span style="color:#099">63</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.2485</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.9062</span>
Epoch <span style="color:#099">10</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">10</span>
<span style="color:#099">60000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">60000</span> [<span style="color:#000;font-weight:bold">==============================</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">4</span>s <span style="color:#099">60</span>us<span style="color:#000;font-weight:bold">/</span>sample <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.2388</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.9100</span>

<span style="color:#000;font-weight:bold">&lt;</span>tensorflow<span style="color:#000;font-weight:bold">.</span>python<span style="color:#000;font-weight:bold">.</span>keras<span style="color:#000;font-weight:bold">.</span>callbacks<span style="color:#000;font-weight:bold">.</span>History at <span style="color:#099">0x7fefe642a860</span><span style="color:#000;font-weight:bold">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>模型训练时，会显示损失和准确度指标。该模型在训练数据上达到0.88（或88%）的准确度。</p>
<h2 id="评估准确性">评估准确性</h2>
<p>接下来，比较下模型在测试数据集上的表现：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">test_loss, test_acc <span style="color:#000;font-weight:bold">=</span> model<span style="color:#000;font-weight:bold">.</span>evaluate(test_images,  test_labels, verbose<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span>)
<span style="color:#000;font-weight:bold">print</span>(<span style="color:#d14">&#39;</span><span style="color:#d14">\n</span><span style="color:#d14">Test accuracy:&#39;</span>, test_acc)

<span style="color:#099">10000</span><span style="color:#000;font-weight:bold">/</span><span style="color:#099">1</span> <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>s <span style="color:#000;font-weight:bold">-</span> loss: <span style="color:#099">0.2934</span> <span style="color:#000;font-weight:bold">-</span> accuracy: <span style="color:#099">0.8830</span>
Test accuracy: <span style="color:#099">0.883</span>
</code></pre></td></tr></table>
</div>
</div><p>结果表明，测试数据集的准确性略低于训练数据集的准确性。训练准确性和测试准确性之间的差距代表过拟合。过拟合是指机器学习模型在新的、看不见的输入上的表现比训练数据上的表现差的情况。</p>
<h2 id="作出预测">作出预测</h2>
<p>通过训练模型，你可以使用它来预测某些图像。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">predictions <span style="color:#000;font-weight:bold">=</span> model<span style="color:#000;font-weight:bold">.</span>predict(test_images)
</code></pre></td></tr></table>
</div>
</div><p>这里，模型已经预测了测试集中每个图像的标签。让我们看一下第一个：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">predictions[<span style="color:#099">0</span>]

array([<span style="color:#099">1.06123218e-06</span>, <span style="color:#099">8.76374884e-09</span>, <span style="color:#099">4.13958730e-07</span>, <span style="color:#099">9.93547733e-09</span>,
       <span style="color:#099">2.39135318e-07</span>, <span style="color:#099">2.61428091e-03</span>, <span style="color:#099">2.91701099e-07</span>, <span style="color:#099">6.94991834e-03</span>,
       <span style="color:#099">1.02351805e-07</span>, <span style="color:#099">9.90433693e-01</span>], dtype<span style="color:#000;font-weight:bold">=</span>float32)
</code></pre></td></tr></table>
</div>
</div><p>预测是由10个数字组成的数组。它们代表模型对应于10种不同服装中的每一种的“把握”。你可以看到哪个标签的置信度最高：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">np<span style="color:#000;font-weight:bold">.</span>argmax(predictions[<span style="color:#099">0</span>])
<span style="color:#099">9</span>
</code></pre></td></tr></table>
</div>
</div><p>因此，模型最有把握的图像是ankle boot或<code>class_names[9]</code>。检查测试标签表明此分类是正确的：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">test_labels[<span style="color:#099">0</span>]
<span style="color:#099">9</span>
</code></pre></td></tr></table>
</div>
</div><p>以图形方式查看完整的10个类的预测。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">plot_image</span>(i, predictions_array, true_label, img):
  predictions_array, true_label, img <span style="color:#000;font-weight:bold">=</span> predictions_array, true_label[i], img[i]
  plt<span style="color:#000;font-weight:bold">.</span>grid(<span style="color:#999">False</span>)
  plt<span style="color:#000;font-weight:bold">.</span>xticks([])
  plt<span style="color:#000;font-weight:bold">.</span>yticks([])

  plt<span style="color:#000;font-weight:bold">.</span>imshow(img, cmap<span style="color:#000;font-weight:bold">=</span>plt<span style="color:#000;font-weight:bold">.</span>cm<span style="color:#000;font-weight:bold">.</span>binary)

  predicted_label <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>argmax(predictions_array)
  <span style="color:#000;font-weight:bold">if</span> predicted_label <span style="color:#000;font-weight:bold">==</span> true_label:
    color <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;blue&#39;</span>
  <span style="color:#000;font-weight:bold">else</span>:
    color <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;red&#39;</span>

  plt<span style="color:#000;font-weight:bold">.</span>xlabel(<span style="color:#d14">&#34;{} {:2.0f}% ({})&#34;</span><span style="color:#000;font-weight:bold">.</span>format(class_names[predicted_label],
                                <span style="color:#099">100</span><span style="color:#000;font-weight:bold">*</span>np<span style="color:#000;font-weight:bold">.</span>max(predictions_array),
                                class_names[true_label]),
                                color<span style="color:#000;font-weight:bold">=</span>color)

<span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">plot_value_array</span>(i, predictions_array, true_label):
  predictions_array, true_label <span style="color:#000;font-weight:bold">=</span> predictions_array, true_label[i]
  plt<span style="color:#000;font-weight:bold">.</span>grid(<span style="color:#999">False</span>)
  plt<span style="color:#000;font-weight:bold">.</span>xticks(<span style="color:#0086b3">range</span>(<span style="color:#099">10</span>))
  plt<span style="color:#000;font-weight:bold">.</span>yticks([])
  thisplot <span style="color:#000;font-weight:bold">=</span> plt<span style="color:#000;font-weight:bold">.</span>bar(<span style="color:#0086b3">range</span>(<span style="color:#099">10</span>), predictions_array, color<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;#777777&#34;</span>)
  plt<span style="color:#000;font-weight:bold">.</span>ylim([<span style="color:#099">0</span>, <span style="color:#099">1</span>])
  predicted_label <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>argmax(predictions_array)

  thisplot[predicted_label]<span style="color:#000;font-weight:bold">.</span>set_color(<span style="color:#d14">&#39;red&#39;</span>)
  thisplot[true_label]<span style="color:#000;font-weight:bold">.</span>set_color(<span style="color:#d14">&#39;blue&#39;</span>)
</code></pre></td></tr></table>
</div>
</div><p>让我们看一下第0张图片的预测和预测数组。正确的预测标签为蓝色，错误的预测标签为红色。数字给出了预测标签的百分比。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">i <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>
plt<span style="color:#000;font-weight:bold">.</span>figure(figsize<span style="color:#000;font-weight:bold">=</span>(<span style="color:#099">6</span>,<span style="color:#099">3</span>))
plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">1</span>,<span style="color:#099">2</span>,<span style="color:#099">1</span>)
plot_image(i, predictions[i], test_labels, test_images)
plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">1</span>,<span style="color:#099">2</span>,<span style="color:#099">2</span>)
plot_value_array(i, predictions[i],  test_labels)
plt<span style="color:#000;font-weight:bold">.</span>show()
</code></pre></td></tr></table>
</div>
</div><p>
        <img class="mx-auto" alt="" src="/images/tfkb4.png" />   
    </p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">i <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">12</span>
plt<span style="color:#000;font-weight:bold">.</span>figure(figsize<span style="color:#000;font-weight:bold">=</span>(<span style="color:#099">6</span>,<span style="color:#099">3</span>))
plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">1</span>,<span style="color:#099">2</span>,<span style="color:#099">1</span>)
plot_image(i, predictions[i], test_labels, test_images)
plt<span style="color:#000;font-weight:bold">.</span>subplot(<span style="color:#099">1</span>,<span style="color:#099">2</span>,<span style="color:#099">2</span>)
plot_value_array(i, predictions[i],  test_labels)
plt<span style="color:#000;font-weight:bold">.</span>show()
</code></pre></td></tr></table>
</div>
</div><p>
        <img class="mx-auto" alt="" src="/images/tfkb5.png" />   
    </p>
<p>让我们用它们的预测来绘制几个图像。请注意，即使非常有把握，该模型也可能是错误的。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#998;font-style:italic"># Plot the first X test images, their predicted labels, and the true labels.</span>
<span style="color:#998;font-style:italic"># Color correct predictions in blue and incorrect predictions in red.</span>
num_rows <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">5</span>
num_cols <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">3</span>
num_images <span style="color:#000;font-weight:bold">=</span> num_rows<span style="color:#000;font-weight:bold">*</span>num_cols
plt<span style="color:#000;font-weight:bold">.</span>figure(figsize<span style="color:#000;font-weight:bold">=</span>(<span style="color:#099">2</span><span style="color:#000;font-weight:bold">*</span><span style="color:#099">2</span><span style="color:#000;font-weight:bold">*</span>num_cols, <span style="color:#099">2</span><span style="color:#000;font-weight:bold">*</span>num_rows))
<span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(num_images):
  plt<span style="color:#000;font-weight:bold">.</span>subplot(num_rows, <span style="color:#099">2</span><span style="color:#000;font-weight:bold">*</span>num_cols, <span style="color:#099">2</span><span style="color:#000;font-weight:bold">*</span>i<span style="color:#000;font-weight:bold">+</span><span style="color:#099">1</span>)
  plot_image(i, predictions[i], test_labels, test_images)
  plt<span style="color:#000;font-weight:bold">.</span>subplot(num_rows, <span style="color:#099">2</span><span style="color:#000;font-weight:bold">*</span>num_cols, <span style="color:#099">2</span><span style="color:#000;font-weight:bold">*</span>i<span style="color:#000;font-weight:bold">+</span><span style="color:#099">2</span>)
  plot_value_array(i, predictions[i], test_labels)
plt<span style="color:#000;font-weight:bold">.</span>tight_layout()
plt<span style="color:#000;font-weight:bold">.</span>show()
</code></pre></td></tr></table>
</div>
</div><p>
        <img class="mx-auto" alt="" src="/images/tfkb6.png" />   
    </p>
<p>最后，使用经过训练的模型对单个图像进行预测。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#998;font-style:italic"># Grab an image from the test dataset.</span>
img <span style="color:#000;font-weight:bold">=</span> test_images[<span style="color:#099">1</span>]
<span style="color:#000;font-weight:bold">print</span>(img<span style="color:#000;font-weight:bold">.</span>shape)

(<span style="color:#099">28</span>, <span style="color:#099">28</span>)
</code></pre></td></tr></table>
</div>
</div><p><code>tf.keras</code>对模型进行了优化，可以同时对一批或一组示例进行预测。因此，即使你使用的是单个图像，也需要将其添加到列表中：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#998;font-style:italic"># Add the image to a batch where it&#39;s the only member.</span>
img <span style="color:#000;font-weight:bold">=</span> (np<span style="color:#000;font-weight:bold">.</span>expand_dims(img,<span style="color:#099">0</span>))
<span style="color:#000;font-weight:bold">print</span>(img<span style="color:#000;font-weight:bold">.</span>shape)

(<span style="color:#099">1</span>, <span style="color:#099">28</span>, <span style="color:#099">28</span>)
</code></pre></td></tr></table>
</div>
</div><p>现在，为该图像预测正确的标签：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">predictions_single <span style="color:#000;font-weight:bold">=</span> model<span style="color:#000;font-weight:bold">.</span>predict(img)
<span style="color:#000;font-weight:bold">print</span>(predictions_single)

[[<span style="color:#099">1.4175281e-04</span> <span style="color:#099">8.5218921e-14</span> <span style="color:#099">9.9798274e-01</span> <span style="color:#099">1.7262291e-11</span> <span style="color:#099">1.3707496e-03</span>
  <span style="color:#099">1.4081123e-14</span> <span style="color:#099">5.0472573e-04</span> <span style="color:#099">6.2876434e-17</span> <span style="color:#099">3.6248435e-09</span> <span style="color:#099">1.8519042e-13</span>]]]

plot_value_array(<span style="color:#099">1</span>, predictions_single[<span style="color:#099">0</span>], test_labels)
_ <span style="color:#000;font-weight:bold">=</span> plt<span style="color:#000;font-weight:bold">.</span>xticks(<span style="color:#0086b3">range</span>(<span style="color:#099">10</span>), class_names, rotation<span style="color:#000;font-weight:bold">=</span><span style="color:#099">45</span>)
</code></pre></td></tr></table>
</div>
</div><p>
        <img class="mx-auto" alt="" src="/images/tfkb7.png" />   
    </p>
<p><code>model.predict</code>返回一系列的列表，每一个列对应于批量数据中的每个图像。在批量数据中获取我们（唯一）图像的预测：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">np<span style="color:#000;font-weight:bold">.</span>argmax(predictions_single[<span style="color:#099">0</span>])
<span style="color:#099">2</span>
</code></pre></td></tr></table>
</div>
</div><p>模型按预期预测了一个标签。</p>

        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://qoanty.github.io/">百年孤独</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://qoanty.github.io/2019/10/tensorflow-image-classification/">https://qoanty.github.io/2019/10/tensorflow-image-classification/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/2019/07/install-lemp-on-debian/">在Debian 10上安装Linux，Nginx，MariaDB，PHP</a></li>
        
        <li><a href="/2019/07/install-nginx-on-debian/">在Debian 10上安装Nginx</a></li>
        
        <li><a href="/2019/07/set-up-debian-server/">在VPS上设置Debian 10服务器</a></li>
        
        <li><a href="/2019/07/initial-server-with-debian/">Debian 10进行初始服务器设置</a></li>
        
        <li><a href="/2019/05/debian-docker/">Debian 10使用Docker方式安装Weixin和QQ</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/tensorflow'>tensorflow</a></li>
                
                <li><a href='/tags/keras'>keras</a></li>
                
                <li><a href='/tags/deep-learning'>deep learning</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2021 <a href="https://qoanty.github.io/">百年孤独的博客 By 百年孤独</a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by </span><span class="badge-value bg-blue">Hugo.</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme base on </span><span class="badge-value bg-yellowgreen">Maupassant.</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>







                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://qoanty.github.io/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://qoanty.github.io/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://qoanty.github.io/2021/05/xray-nginx-sni/" title="Nginx SNI分流（端口复用）使用Xray&#43;VLESS&#43;XTLS">Nginx SNI分流（端口复用）使用Xray&#43;VLESS&#43;XTLS</a>
    </li>
    
    <li>
        <a href="https://qoanty.github.io/2021/04/xray-fallbacks-sni/" title="Xray通过SNI回落功能实现伪装与按域名分流">Xray通过SNI回落功能实现伪装与按域名分流</a>
    </li>
    
    <li>
        <a href="https://qoanty.github.io/2021/04/xray-vless-fallbacks/" title="Xray VLESS协议的fallback功能简析">Xray VLESS协议的fallback功能简析</a>
    </li>
    
    <li>
        <a href="https://qoanty.github.io/2021/04/vps-with-xray/" title="Xray教程">Xray教程</a>
    </li>
    
    <li>
        <a href="https://qoanty.github.io/2021/03/v2ray-vless-fallbacks/" title="VLESS协议的fallback参数介绍">VLESS协议的fallback参数介绍</a>
    </li>
    
    <li>
        <a href="https://qoanty.github.io/2021/03/v2ray-vless-protocal/" title="V2ray的VLESS协议介绍和使用">V2ray的VLESS协议介绍和使用</a>
    </li>
    
    <li>
        <a href="https://qoanty.github.io/2021/02/vps-caddy2/" title="Caddy 2安装与配置">Caddy 2安装与配置</a>
    </li>
    
    <li>
        <a href="https://qoanty.github.io/2020/07/install-manjaro-kde/" title="Manjaro-KDE 安装与设置">Manjaro-KDE 安装与设置</a>
    </li>
    
    <li>
        <a href="https://qoanty.github.io/2020/06/vps-with-trojan-go/" title="Trojan-Go 安装配置教程">Trojan-Go 安装配置教程</a>
    </li>
    
    <li>
        <a href="https://qoanty.github.io/2019/10/tensorflow-without-phd/" title="Tensorflow, Keras and deep learning, without a Phd">Tensorflow, Keras and deep learning, without a Phd</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://qoanty.github.io/categories/blog/">Blog (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/caddy/">Caddy (2)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/captcha/">Captcha (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/debian/">Debian (5)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/docker/">Docker (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/hugo/">Hugo (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/kde/">KDE (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/kms/">KMS (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/learn/">Learn (14)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/manjaro/">Manjaro (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/nginx/">Nginx (2)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/pipenv/">Pipenv (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/python/">Python (12)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/sni/">SNI (2)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/ssh/">SSH (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/tensorflow/">TensorFlow (5)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/trojan/">Trojan (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/trojan-go/">Trojan-Go (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/v2ray/">v2ray (4)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/vim/">Vim (1)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/vless/">VLESS (3)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/vps/">VPS (9)</a></li>
    
    <li><a href="https://qoanty.github.io/categories/xray/">xray (4)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>标签</a></h3>
<div class="tagcloud">
    
    <a href="https://qoanty.github.io/tags/asyncio/">asyncio</a>
    
    <a href="https://qoanty.github.io/tags/caddy/">Caddy</a>
    
    <a href="https://qoanty.github.io/tags/cdn/">CDN</a>
    
    <a href="https://qoanty.github.io/tags/data/">data</a>
    
    <a href="https://qoanty.github.io/tags/debian/">Debian</a>
    
    <a href="https://qoanty.github.io/tags/deep-learning/">deep learning</a>
    
    <a href="https://qoanty.github.io/tags/docker/">Docker</a>
    
    <a href="https://qoanty.github.io/tags/features/">features</a>
    
    <a href="https://qoanty.github.io/tags/functions/">functions</a>
    
    <a href="https://qoanty.github.io/tags/geetest/">geetest</a>
    
    <a href="https://qoanty.github.io/tags/github/">Github</a>
    
    <a href="https://qoanty.github.io/tags/hugo/">Hugo</a>
    
    <a href="https://qoanty.github.io/tags/ide/">IDE</a>
    
    <a href="https://qoanty.github.io/tags/kde/">KDE</a>
    
    <a href="https://qoanty.github.io/tags/keras/">keras</a>
    
    <a href="https://qoanty.github.io/tags/kms/">KMS</a>
    
    <a href="https://qoanty.github.io/tags/manjaro/">Manjaro</a>
    
    <a href="https://qoanty.github.io/tags/nginx/">Nginx</a>
    
    <a href="https://qoanty.github.io/tags/oop/">OOP</a>
    
    <a href="https://qoanty.github.io/tags/pipenv/">Pipenv</a>
    
    <a href="https://qoanty.github.io/tags/processes/">processes</a>
    
    <a href="https://qoanty.github.io/tags/python/">Python</a>
    
    <a href="https://qoanty.github.io/tags/scraping/">scraping</a>
    
    <a href="https://qoanty.github.io/tags/sni/">SNI</a>
    
    <a href="https://qoanty.github.io/tags/ssh/">SSH</a>
    
    <a href="https://qoanty.github.io/tags/tensorflow/">tensorflow</a>
    
    <a href="https://qoanty.github.io/tags/trojan/">Trojan</a>
    
    <a href="https://qoanty.github.io/tags/trojan-go/">Trojan-Go</a>
    
    <a href="https://qoanty.github.io/tags/v2ray/">v2ray</a>
    
    <a href="https://qoanty.github.io/tags/vim/">Vim</a>
    
    <a href="https://qoanty.github.io/tags/vless/">VLESS</a>
    
    <a href="https://qoanty.github.io/tags/vps/">VPS</a>
    
    <a href="https://qoanty.github.io/tags/xray/">xray</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://python3-cookbook.readthedocs.io/zh_CN/latest/index.html" title="Python Cookbook 3rd Edition">Python Cookbook</a>
        </li>
        
        <li>
            <a target="_blank" href="https://seancheney.gitbook.io/python-for-data-analysis-2nd/" title="Python for Data Analysis 2nd Edition">Python for Data Analysis</a>
        </li>
        
        <li>
            <a target="_blank" href="https://codelabs.developers.google.com/codelabs/cloud-tensorflow-mnist/#0" title="TensorFlow and deep learning, without a PhD">TensorFlow and deep learning</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://qoanty.github.io/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>